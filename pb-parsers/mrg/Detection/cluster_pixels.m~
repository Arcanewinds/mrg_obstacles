function clusters = cluster_pixels(image)

    [row, col] = find(image(:, :, 1) > 0);
    coords = cat(2, col, row);
    coords(:,3) = find(coords(:,1) > 0);
    clusters = zeros(size(coords,1),3);
    clusters(:,1) = col(:);
    clusters(:,2) = row(:);
   
    num_c = 0;
    cont = 1;
    while(cont)
        num_c = num_c + 1; %increment number of clusters
        c_members = 1; %Number of members in cluster
        c_idx = coords(1,3); %index of first member
        coords(c_idx, :) = []; %delete from search list
        clusters(c_idx, 3) = num_c; %add class label to output
        
        unclustered = size(coords,1); %number to search

        if(unclustered > 5)
            THRESHOLD = 2.8; %Euclidean distance, grabs 2 nearest pixels inc. 2x+1y|2y+1x
            for j = 1:c_members
                new_members = 0;
                dist = zeros(unclustered, 1);
                for i = 1:unclustered
                    dist = sqrt(abs(clusters(c_idx(j), 1) - coords(i, 1)).^2 + abs(clusters(c_idx(j), 2) - coords(i, 2)).^2);
                    if(dist < THRESHOLD)
                        clusters(i, 3) = num_c;
                        new_members = new_members + 1;
                        c_idx = cat(1,c_idx,i);
                    end
                end
                unclustered = unclustered - new_members;
                c_members = c_members + new_members;
                st = c_members - new_members;
                coords(c_idx(st:end), :) = [];
            end    
        end
    end
end
            
            
            
            
            
            
            
           